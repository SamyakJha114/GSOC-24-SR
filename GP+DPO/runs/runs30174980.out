Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: torch in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (2.4.0)
Requirement already satisfied: filelock in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (3.15.4)
Requirement already satisfied: typing-extensions>=4.8.0 in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (4.9.0)
Requirement already satisfied: sympy in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (1.12)
Requirement already satisfied: networkx in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (3.2.1)
Requirement already satisfied: jinja2 in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (3.1.2)
Requirement already satisfied: fsspec in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (2023.12.2)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: triton==3.0.0 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (3.0.0)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch) (12.6.68)
Requirement already satisfied: MarkupSafe>=2.0 in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from jinja2->torch) (2.1.3)
Requirement already satisfied: mpmath>=0.19 in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from sympy->torch) (1.3.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: deap in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (1.4.1)
Requirement already satisfied: numpy in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from deap) (1.26.3)
current file index :-  7
1000000
Cycle 1/4
Length of seed expression array :- 67
num_cores  128
67 64
gen	nevals	avg        	std        	min      	max        
0  	0     	4.91271e+16	4.88801e+17	0.0263635	4.91263e+18
1  	60    	inf        	nan        	0.0053641	inf        
2  	67    	inf        	nan        	0.00479431	inf        
3  	72    	inf        	nan        	0.00260735	inf        
4  	65    	inf        	nan        	0.00260735	inf        
5  	67    	inf        	nan        	0.00260735	inf        
6  	70    	inf        	nan        	0.00258521	inf        
7  	53    	inf        	nan        	0.00258521	inf        
Best individual: mul(protected_log(cos(tan(3))), mul(-1, s_1))
Fitness: (0.002585206439227067,)
R2_score with noisy data: 0.9999459774891256
R2_score with original data: 0.9999459774891256
best :-  mul(protected_log(cos(tan(3))), mul(-1, s_1))
GENERATING PREFERENCE PAIRS
1456
TRAINING THE TRANSFORMER
TESTING
Epoch [1/10], TEST Loss: 0.41225730500196756
TRAINING THE TRANSFORMER
TESTING
Epoch [2/10], TEST Loss: 0.3455255456421881
TRAINING THE TRANSFORMER
TESTING
Epoch [3/10], TEST Loss: 0.3255437431244613
TRAINING THE TRANSFORMER
TESTING
Epoch [4/10], TEST Loss: 0.3094770144288466
TRAINING THE TRANSFORMER
TESTING
Epoch [5/10], TEST Loss: 0.2938495723064989
TRAINING THE TRANSFORMER
TESTING
Epoch [6/10], TEST Loss: 0.28738128179237754
TRAINING THE TRANSFORMER
TESTING
Epoch [7/10], TEST Loss: 0.2873709698411802
TRAINING THE TRANSFORMER
TESTING
Epoch [8/10], TEST Loss: 0.2856728974953039
TRAINING THE TRANSFORMER
TESTING
Epoch [9/10], TEST Loss: 0.2856048328278918
TRAINING THE TRANSFORMER
TESTING
Epoch [10/10], TEST Loss: 0.2856244599376486
Cycle 2/4
Length of seed expression array :- 75
num_cores  128
75 0
gen	nevals	avg    	std    	min       	max   
0  	0     	3066.56	26998.3	0.00530045	270958
1  	55    	298782 	2.87511e+06	0.00530045	2.88891e+07
2  	59    	135439 	1.34573e+06	0.00530045	1.35253e+07
3  	59    	4.9685e+11	4.9436e+12 	0.00304972	4.9685e+13 
4  	56    	1.2756e+42	1.2692e+43 	0.00244444	1.2756e+44 
5  	54    	1.68078e+198	inf        	0.00176142	1.68078e+200
6  	59    	inf         	nan        	0.00176142	inf         
7  	59    	inf         	nan        	0.00176142	inf         
Best individual: protected_pow(mul(protected_exp(3), s_2), sin(4))
Fitness: (0.0017614215512875458,)
R2_score with noisy data: 0.9999631919472793
R2_score with original data: 0.9999631919472793
best :-  protected_pow(mul(protected_exp(3), s_2), sin(4))
GENERATING PREFERENCE PAIRS
1484
TRAINING THE TRANSFORMER
TESTING
Epoch [1/10], TEST Loss: 0.18456841339409324
TRAINING THE TRANSFORMER
TESTING
Epoch [2/10], TEST Loss: 0.10340818473077873
TRAINING THE TRANSFORMER
TESTING
Epoch [3/10], TEST Loss: 0.09533319866671075
TRAINING THE TRANSFORMER
TESTING
Epoch [4/10], TEST Loss: 0.0782135022746519
TRAINING THE TRANSFORMER
TESTING
Epoch [5/10], TEST Loss: 0.07228945186623884
TRAINING THE TRANSFORMER
TESTING
Epoch [6/10], TEST Loss: 0.06988370969592429
TRAINING THE TRANSFORMER
TESTING
Epoch [7/10], TEST Loss: 0.06921871204871259
TRAINING THE TRANSFORMER
TESTING
Epoch [8/10], TEST Loss: 0.06819627315912327
TRAINING THE TRANSFORMER
TESTING
Epoch [9/10], TEST Loss: 0.06804375220804891
TRAINING THE TRANSFORMER
TESTING
Epoch [10/10], TEST Loss: 0.06788499102794943
Cycle 3/4
Length of seed expression array :- 75
num_cores  128
75 50
gen	nevals	avg        	std        	min       	max        
0  	0     	3.64969e+79	3.63139e+80	0.00296549	3.64969e+81
1  	49    	8e+12      	2.71293e+13	0.00296549	1e+14      
2  	50    	2.00001e+12	1.4e+13    	0.00296549	1e+14      
3  	48    	1.7664e+25 	1.75754e+26	0.00296549	1.7664e+27 
4  	54    	1.7664e+25 	1.75754e+26	0.00292895	1.7664e+27 
5  	55    	1.97947e+20	9.69738e+20	0.00253178	4.94867e+21
6  	67    	1.4846e+20 	8.4418e+20 	0.00212769	4.94867e+21
7  	61    	9.09247e+09	8.51164e+10	0.00212769	8.54238e+11
Best individual: protected_div(tan(protected_div(tan(4), s_5)), mul(protected_sqrt(s_2), pi))
Fitness: (0.002127686265722325,)
R2_score with noisy data: 0.9999555381911931
R2_score with original data: 0.9999555381911931
best :-  protected_div(tan(protected_div(tan(4), s_5)), mul(protected_sqrt(s_2), pi))
GENERATING PREFERENCE PAIRS
1522
TRAINING THE TRANSFORMER
TESTING
Epoch [1/10], TEST Loss: 0.2497444341112992
TRAINING THE TRANSFORMER
TESTING
Epoch [2/10], TEST Loss: 0.09672359401899175
TRAINING THE TRANSFORMER
TESTING
Epoch [3/10], TEST Loss: 0.10258559250687434
TRAINING THE TRANSFORMER
TESTING
Epoch [4/10], TEST Loss: 0.10208962523866201
TRAINING THE TRANSFORMER
TESTING
Epoch [5/10], TEST Loss: 0.06006605917754752
TRAINING THE TRANSFORMER
TESTING
Epoch [6/10], TEST Loss: 0.05693831907206292
TRAINING THE TRANSFORMER
TESTING
Epoch [7/10], TEST Loss: 0.06377555085960332
TRAINING THE TRANSFORMER
TESTING
Epoch [8/10], TEST Loss: 0.06046388626365309
TRAINING THE TRANSFORMER
TESTING
Epoch [9/10], TEST Loss: 0.061083493852613066
TRAINING THE TRANSFORMER
TESTING
Epoch [10/10], TEST Loss: 0.060458520124337264
Cycle 4/4
Length of seed expression array :- 75
num_cores  128
75 75
gen	nevals	avg    	std    	min       	max    
0  	0     	61.9956	352.216	0.00530045	3080.58
