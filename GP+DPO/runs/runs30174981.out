Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: torch in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (2.4.0)
Requirement already satisfied: filelock in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (3.15.4)
Requirement already satisfied: typing-extensions>=4.8.0 in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (4.9.0)
Requirement already satisfied: sympy in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (1.12)
Requirement already satisfied: networkx in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (3.2.1)
Requirement already satisfied: jinja2 in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (3.1.2)
Requirement already satisfied: fsspec in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from torch) (2023.12.2)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: triton==3.0.0 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from torch) (3.0.0)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch) (12.6.68)
Requirement already satisfied: MarkupSafe>=2.0 in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from jinja2->torch) (2.1.3)
Requirement already satisfied: mpmath>=0.19 in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from sympy->torch) (1.3.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: deap in /global/homes/s/samyak09/.local/perlmutter/python-3.11/lib/python3.11/site-packages (1.4.1)
Requirement already satisfied: numpy in /global/common/software/nersc/pe/conda-envs/24.1.0/python-3.11/nersc-python/lib/python3.11/site-packages (from deap) (1.26.3)
current file index :-  7
1000000
Cycle 1/4
Length of seed expression array :- 67
num_cores  128
67 64
gen	nevals	avg        	std        	min      	max        
0  	0     	4.91271e+16	4.88801e+17	0.0263914	4.91263e+18
1  	60    	inf        	nan        	0.00538834	inf        
2  	70    	inf        	nan        	0.00494742	inf        
3  	72    	1.38287e+27	1.36854e+28	0.00219315	1.37549e+29
4  	57    	2.69962e+83	2.68609e+84	0.00219315	2.69962e+85
5  	67    	1.08985e+113	1.08438e+114	0.00219315	1.08985e+115
6  	58    	4.00443e+185	inf         	0.00219315	4.00443e+187
7  	59    	1.95564e+42 	1.94584e+43 	0.0021633 	1.95564e+44 
Best individual: mul(protected_log(mul(mul(-1, protected_log(mul(mul(-1, protected_log(3)), 3))), s_3)), protected_pow(3, mul(cos(abs(3)), s_3)))
Fitness: (0.002163296433913218,)
R2_score with noisy data: 0.9999552072385002
R2_score with original data: 0.9999551946400097
best :-  mul(protected_log(mul(mul(-1, protected_log(mul(mul(-1, protected_log(3)), 3))), s_3)), protected_pow(3, mul(cos(abs(3)), s_3)))
GENERATING PREFERENCE PAIRS
1424
TRAINING THE TRANSFORMER
TESTING
Epoch [1/10], TEST Loss: 0.42874140219463336
TRAINING THE TRANSFORMER
TESTING
Epoch [2/10], TEST Loss: 0.36690223510084036
TRAINING THE TRANSFORMER
TESTING
Epoch [3/10], TEST Loss: 0.33241871628467434
TRAINING THE TRANSFORMER
TESTING
Epoch [4/10], TEST Loss: 0.30349494457583537
TRAINING THE TRANSFORMER
TESTING
Epoch [5/10], TEST Loss: 0.3018082957975306
TRAINING THE TRANSFORMER
TESTING
Epoch [6/10], TEST Loss: 0.3011666728652545
TRAINING THE TRANSFORMER
TESTING
Epoch [7/10], TEST Loss: 0.2997362321125461
TRAINING THE TRANSFORMER
TESTING
Epoch [8/10], TEST Loss: 0.29839238395484596
TRAINING THE TRANSFORMER
TESTING
Epoch [9/10], TEST Loss: 0.2983748930591074
TRAINING THE TRANSFORMER
TESTING
Epoch [10/10], TEST Loss: 0.2982869941376514
Cycle 2/4
Length of seed expression array :- 72
num_cores  128
72 72
gen	nevals	avg        	std        	min       	max        
0  	0     	1.80501e+06	7.38859e+06	0.00532548	7.25649e+07
1  	57    	304148     	3.00977e+06	0.00532548	3.02509e+07
2  	64    	10217.8    	98281.6    	0.00260066	987932     
3  	64    	10299.8    	98328.7    	0.00260066	987932     
4  	66    	399.906    	3783.44    	0.00260066	38014.6    
5  	68    	973.788    	8912.39    	0.00260066	89522.2    
6  	50    	45.1634    	439.476    	0.00189469	4417.57    
7  	67    	5.78818    	47.4545    	0.00189469	475.326    
Best individual: protected_div(cos(protected_log(pi)), mul(abs(s_2), 4))
Fitness: (0.0018946923163982263,)
R2_score with noisy data: 0.9999607688989297
R2_score with original data: 0.9999609129074928
best :-  protected_div(cos(protected_log(pi)), mul(abs(s_2), 4))
GENERATING PREFERENCE PAIRS
1462
TRAINING THE TRANSFORMER
TESTING
Epoch [1/10], TEST Loss: 0.3578997428471945
TRAINING THE TRANSFORMER
TESTING
Epoch [2/10], TEST Loss: 0.3011862990512912
TRAINING THE TRANSFORMER
TESTING
Epoch [3/10], TEST Loss: 0.3015341203078488
TRAINING THE TRANSFORMER
TESTING
Epoch [4/10], TEST Loss: 0.24543307528736377
TRAINING THE TRANSFORMER
TESTING
Epoch [5/10], TEST Loss: 0.24220841725333714
TRAINING THE TRANSFORMER
TESTING
Epoch [6/10], TEST Loss: 0.24055190945302432
TRAINING THE TRANSFORMER
TESTING
Epoch [7/10], TEST Loss: 0.24127388843061498
TRAINING THE TRANSFORMER
TESTING
Epoch [8/10], TEST Loss: 0.23261816576112843
TRAINING THE TRANSFORMER
TESTING
Epoch [9/10], TEST Loss: 0.23339797099121212
TRAINING THE TRANSFORMER
TESTING
Epoch [10/10], TEST Loss: 0.2341118936005625
Cycle 3/4
Length of seed expression array :- 50
num_cores  128
50 50
gen	nevals	avg       	std        	min       	max       
0  	0     	7.7572e+15	7.71832e+16	0.00210673	7.7572e+17
1  	69    	101.406   	1002.1     	0.00210673	10072.2   
2  	51    	5.69177   	52.0364    	0.00210673	522.883   
3  	60    	107.501   	669.286    	0.00210673	5386.94   
4  	53    	11.8966   	112.164    	0.00210673	1127.61   
5  	61    	1030.68   	7511.01    	0.00210673	74193.5   
6  	61    	440.54    	4041.78    	0.00210673	40562.1   
7  	60    	291845    	2.90373e+06	0.00210673	2.91836e+07
Best individual: protected_div(protected_log(s_1), protected_exp(pi))
Fitness: (0.0021067284372159375,)
R2_score with noisy data: 0.9999563785235561
R2_score with original data: 0.9999564728576611
best :-  protected_div(protected_log(s_1), protected_exp(pi))
GENERATING PREFERENCE PAIRS
1516
TRAINING THE TRANSFORMER
TESTING
Epoch [1/10], TEST Loss: 0.26176970736917393
TRAINING THE TRANSFORMER
TESTING
Epoch [2/10], TEST Loss: 0.21620223802064456
TRAINING THE TRANSFORMER
TESTING
Epoch [3/10], TEST Loss: 0.23514418635283943
TRAINING THE TRANSFORMER
TESTING
Epoch [4/10], TEST Loss: 0.18335343805077425
TRAINING THE TRANSFORMER
TESTING
Epoch [5/10], TEST Loss: 0.07771778492605061
TRAINING THE TRANSFORMER
TESTING
Epoch [6/10], TEST Loss: 0.06973562883072472
TRAINING THE TRANSFORMER
TESTING
Epoch [7/10], TEST Loss: 0.06948990085339043
TRAINING THE TRANSFORMER
TESTING
Epoch [8/10], TEST Loss: 0.06800236975122387
TRAINING THE TRANSFORMER
TESTING
Epoch [9/10], TEST Loss: 0.06723470772483629
TRAINING THE TRANSFORMER
TESTING
Epoch [10/10], TEST Loss: 0.06656082313470166
Cycle 4/4
Length of seed expression array :- 25
num_cores  128
25 25
gen	nevals	avg        	std       	min       	max        
0  	0     	2.51944e+09	2.5068e+10	0.00532548	2.51943e+11
1  	42    	208.356    	1464.77   	0.00532548	11746.6    
2  	59    	10415.9    	98271.9   	0.00337162	987932     
3  	62    	9901.58    	98295.9   	0.00172691	987932     
4  	60    	106.1      	1001.82   	0.00172589	10072.2    
5  	56    	4.2138e+82 	4.19267e+83	0.00172589	4.2138e+84 
6  	61    	22.7649    	125.122    	0.00172589	907.473    
7  	70    	2893.23    	21706      	0.00172589	209780     
Best individual: protected_div(tanh(sin(sin(3))), s_3)
Fitness: (0.0017258933647172163,)
R2_score with noisy data: 0.9999642640145623
R2_score with original data: 0.999964357164606
best :-  protected_div(tanh(sin(sin(3))), s_3)
GENERATING PREFERENCE PAIRS
1532
TRAINING THE TRANSFORMER
TESTING
Epoch [1/10], TEST Loss: 2.4366040407375693
TRAINING THE TRANSFORMER
TESTING
Epoch [2/10], TEST Loss: 0.4423184336579468
TRAINING THE TRANSFORMER
TESTING
Epoch [3/10], TEST Loss: 0.21768268451673506
TRAINING THE TRANSFORMER
TESTING
Epoch [4/10], TEST Loss: 0.3677429788749612
TRAINING THE TRANSFORMER
TESTING
Epoch [5/10], TEST Loss: 0.10031540380040954
TRAINING THE TRANSFORMER
TESTING
Epoch [6/10], TEST Loss: 0.10332581365996822
TRAINING THE TRANSFORMER
TESTING
Epoch [7/10], TEST Loss: 0.09106089698838829
TRAINING THE TRANSFORMER
TESTING
Epoch [8/10], TEST Loss: 0.08669047886045847
TRAINING THE TRANSFORMER
TESTING
Epoch [9/10], TEST Loss: 0.08617368644068946
TRAINING THE TRANSFORMER
TESTING
Epoch [10/10], TEST Loss: 0.08390996594242553
current file index :-  8
1000000
Cycle 1/4
Length of seed expression array :- 75
num_cores  128
75 65
gen	nevals	avg        	std        	min    	max        
0  	0     	7.82349e+11	7.78427e+12	10.4781	7.82349e+13
1  	60    	inf        	nan        	10.4781	inf        
2  	67    	26468.8    	209168     	10.4781	2.03709e+06
3  	63    	61797.1    	305472     	10.4781	2.03709e+06
4  	53    	inf        	nan        	10.4781	inf        
5  	67    	inf        	nan        	10.4781	inf        
6  	57    	6.01246e+18	5.98232e+19	10.4781	6.01246e+20
7  	53    	2.42686e+199	inf        	10.4781	2.42686e+201
Best individual: mul(s_1, s_2)
Fitness: (10.478083258187008,)
R2_score with noisy data: 0.9999795172040891
R2_score with original data: 0.9999797739977535
best :-  mul(s_1, s_2)
GENERATING PREFERENCE PAIRS
1018
TRAINING THE TRANSFORMER
TESTING
Epoch [1/10], TEST Loss: 0.46293624563544405
TRAINING THE TRANSFORMER
TESTING
Epoch [2/10], TEST Loss: 0.4067791844992077
TRAINING THE TRANSFORMER
TESTING
Epoch [3/10], TEST Loss: 0.34453577716268746
TRAINING THE TRANSFORMER
TESTING
Epoch [4/10], TEST Loss: 0.32434475033854443
TRAINING THE TRANSFORMER
TESTING
Epoch [5/10], TEST Loss: 0.32219248139025536
TRAINING THE TRANSFORMER
TESTING
Epoch [6/10], TEST Loss: 0.3200013681917506
TRAINING THE TRANSFORMER
TESTING
Epoch [7/10], TEST Loss: 0.3183673478014694
TRAINING THE TRANSFORMER
TESTING
Epoch [8/10], TEST Loss: 0.3161345677651173
TRAINING THE TRANSFORMER
TESTING
Epoch [9/10], TEST Loss: 0.3161400503013283
TRAINING THE TRANSFORMER
TESTING
Epoch [10/10], TEST Loss: 0.3160428787289443
Cycle 2/4
Length of seed expression array :- 75
num_cores  128
75 75
gen	nevals	avg        	std        	min    	max        
0  	0     	2.66709e+30	2.65372e+31	10.4781	2.66709e+32
1  	57    	41879.4    	265665     	10.4781	2.58682e+06
2  	58    	6.08334e+12	5.57289e+13	10.4781	5.58369e+14
3  	56    	299728     	2.90608e+06	10.4781	2.92096e+07
4  	51    	1.94787e+12	1.9381e+13 	10.4781	1.94787e+14
5  	62    	1.69524e+07	1.6865e+08 	10.4781	1.695e+09  
6  	69    	1.69604e+07	1.68649e+08	10.4781	1.695e+09  
7  	58    	9325.09    	60542.9    	10.4781	486271     
Best individual: mul(s_1, s_2)
Fitness: (10.478083258187008,)
R2_score with noisy data: 0.9999795172040891
R2_score with original data: 0.9999797739977535
best :-  mul(s_1, s_2)
GENERATING PREFERENCE PAIRS
1476
